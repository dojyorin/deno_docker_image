{
    "name": "test",
    "on": {
        "push": {
            "branches-ignore": [
                "master"
            ],
            "paths-ignore": [
                ".git*",
                "**.md"
            ]
        },
        "pull_request": {
            "branches": [
                "master"
            ],
            "paths-ignore": [
                ".git*",
                "**.md"
            ]
        }
    },
    "jobs": {
        "test": {
            "name": "test: ${{matrix.file}}",
            "runs-on": "ubuntu-latest",
            "strategy": {
                "fail-fast": true,
                "matrix": {
                    "file": [
                        "alpine",
                        "distroless"
                    ]
                }
            },
            "env": {
                "tag_f": "${{github.repository_owner}}/deno:${{matrix.file}}-${{github.ref_name}}",
                "tag_d": "${{github.repository_owner}}/deno:${{matrix.file}}",
                "tag_v": "${{github.repository_owner}}/deno:${{github.ref_name}}",
                "tag_l": "${{github.repository_owner}}/deno:latest"
            },
            "steps": [{
                "name": "clone repository",
                "uses": "actions/checkout@v3"
            }, {
                "name": "install docker-qemu",
                "uses": "docker/setup-qemu-action@v3"
            }, {
                "name": "install docker-buildx",
                "uses": "docker/setup-buildx-action@v3"
            }, {
                "name": "test build",
                "run": "docker buildx build --compress --no-cache --force-rm -f ./distroless.dockerfile --platforms linux/amd64 -t ${{tag_d}} ./src"
            }, {
                "name": "list image",
                "run": "docker image list"
            }, {
                "name": "run test",
                "run": "docker run --init --rm ${{env.tag_d}} eval -p 'new Date()'"
            }]
        }
    }
}